# The Y-64 class-two architecture reference manual

## Scope

This manual describes the Y-64 processor and system-on-chip internals for Lunota / OSMORA
chip and firmware engineers. This manual also describes various component interfaces.

## Terminology

```
Processing domain)
    A processing domain (PD) is a single processor core [unit of execution]
    consisting of its own register bank, ALU, control unit, etc.

Bootstrap PD)
    The bootstrap processing domain is the first processing domain to be brought
    up when the system is powered up.

PC inhibit line)
    Describes an electrical connection to a processing domain that results in
    the program counter being held if set.
```

## Machine power-up state

When power is driven to the SoC, the RESET signal is immediately asserted to the
bootstrap processing domain. This in turn results in all registers (excluding FP,
SP, TT, and control registers) being initialized to a fixed bit-pattern [0x1A1F1A1F1A1F1A1F].

All control registers as well as the stack pointer (SP) and frame pointer (FP) are to
be initialized to zero. The program counter register is to be initialized to a value of
zero which is mapped to external SPI flash or internal ROM depending on the chip series.

All other processing domains are to have their PC inhibit line asserted until woken up by
the bootstrap processing domain.

## Memory map listing

```
START         END           PURPOSE
-------------------------------------------------------
0x000000    0x100000      BIOS FLASH ROM
0x100000    0x110000      PD LOCAL CACHE
0x110000    0x111000      CHIPSET REGISTERS
-------------------------------------------------------
```

### Chipset registers


```
BYTE          NAME               PURPOSE
-------------------------------------------------------
0             MEMCTL         Memory control register
-------------------------------------------------------
```

### Chipset memory control register


```
BITS          NAME               PURPOSE
-------------------------------------------------------
0            CG                Cache gate
7:2          Reserved          Reserved for future use
-------------------------------------------------------
```

The ``CG`` bit enables access to external RAM during early init, writes of zero are ignored.
If a written value of 1 does not stick, platform firmware is to assume the lack of external
RAM.
